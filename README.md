# 加快SCADA工程开发的自用小工具

此工具目前只有三个功能。

KingSCADA3.7的IOServer采集点的新建，目前只支持西门子1200、1500和300系列的PLC，部分AB系列PLC，采集点位的模板可以修改配置。

北控集团SED系统上传的点位，目前只正常西门子的设备，上传点位的模板可以自行配置。

批量的语音生成功能，生成wav格式文件，文件名称就是语音内容，主要用于报警语音的制作。

工具源码：[https://github.com/qsc20001102/SCADA-Tools](https://github.com/qsc20001102/SCADA-Tools)

打包后可执行文件：[SCADA-Tools.zip](/upload/SCADA-Tools.zip)

解压后运行exe文件即可。

## 一、KingSCADA点表生成


### 配置文件

解压完成后的文件里面有一个 **config\_kingscada** 的文件夹，打开后里面是有两个 **SIEMENS** 和 **AB** 两个文件夹代表了设备类型。这个两个文件夹里放着配置采集点位模板的JSON文件，以记事本打开可以自行修改（模板的字段不可修改，只修改后面的值）。目前模板是配置好的，自用的话不需要修改都是和程序对应的。

程序运行后先选择设备类型，选择完成后自动识别改文件夹内的所有模板，可在模板文件中进行选择，选择完成后在下方表格中出现模板的内容。

### 批量生成

解压完成后的文件里面有一个 **input\_data** 的文件夹，里面有两个文件是提前做好的测试用的设备数据，使用时直接将实际的设备数据替换里面的内容即可，或者直接复制一份修改也可以。表格共三列。第一行内容不要修改，下面的所有行可以自行修改，AB和SIEMENS的文件第一行是一样的，区别在于第三列的内容，因为采集方式不一样。

点击选择SCV文件，自行选择文件，只要是具备第一行三个列名的文件都能导入进来

**批量点表生成：**将列表里面的所有数据进行拼接生成点表。

**拼接的规则**：

导入文件的设备代号列和模板文件中名称列的所有数据进行拼接，设备名称列和模板文件的描述列进行拼接，拼接地址列和模板文件的地址列进行相加和拼接处理。设备类型不同拼接方式也有区别

### 参数输入

这里面的参数基本所指的基本都是IOserver里面的参数。

**起始ID：**采集点的起始IO，项目唯一不能重复，程序生成时每行数据加1。

**设备名称：**在IOServer中对应采集设备的名字。

**分组路径：**在IOServer中采集点位分组路径，用**“.”**区分层级。

**设备分组：**启用后将在分组路径后面自动拼接**“.设备代号”**，最后呈现的效果就是每一个设备都会生成一个分组。

**采集链路：**采集设备对应的采集链路，一般西门子的设备采用以太网链路，AB使用COM。

**IP地址：**如果前面选择了以太网，这里出现的就是IP地址，否则出现的就是串口号。

**设备系列：**依据实际选择

**驱动通道：**依据实际选择

**DB块号：**这个只有在选择设备为西门子的时候才会出现，AB没有。

### 单组生成

**设备代号：**手动输入数据

**设备名称：**手动输入数据

**拼接地址：**手动输入数据

**单组点表生成：**依据前面填写的三个参数生成对应的一组点表。

## 二·、北控SED上传点表生成

### 配置文件选择

用法和上面一基本一直，需要注意这里面的模板用的是 **config\_bewgsed** 里面的东西，模板内的JOSN文件可以通过记事本打开进行修改，自用的话也不用修改，已经都安装北控的点位配置好了。

### 参数输入

这里面提到的参数基本都不要改，因为目前只支持上传西门子设备的点位，这些都是西门子设备的固定配置，唯一需要修改的可能就是 **DB块号**。

## 三、批量文本转语音

### 文本数据导入

解压完成后的文件里面有一个 **input\_data** 的文件夹，里面有一个TTS的csv文件，除了第一行保留，下面的内容可以自行替换，选择文件完成后，文件的内容就行出现在左侧，也就是要批量生成的语音文本。

### 语音参数

这里面目前只要语言这一项是有小的其他可以不用关，因为掉用的edgeTTS的API接口，没有钱，只能用免费的功能，不过语音的种类非常多。语音文本这里面的内容是生成单条语音用的，输入文本后点击单条语音生成按钮，即可生成一条对应的语音，弹出生成文件路径。下面的批量语音生成的按钮就是生成左侧列表里的所有语音文本。